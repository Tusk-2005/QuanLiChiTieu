{% extends "expenses/base.html" %}
{% block content %}
<style>
  .exp-section-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 1.5rem;
  }

  .exp-section-title {
    font-size: 1.6rem;
    font-weight: 600;
  }

  .exp-section-subtitle {
    font-size: 0.9rem;
    color: #6c757d;
  }

  .exp-card {
    border-radius: 18px;
    border: 1px solid #dee2e6;
    box-shadow: 0 14px 35px rgba(0, 0, 0, 0.08);
    transition:
      transform 0.18s ease-out,
      box-shadow 0.18s ease-out,
      border-color 0.18s ease-out;
    background-color: #ffffff;
  }

  .exp-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 18px 55px rgba(0, 0, 0, 0.14);
    border-color: #000000;
  }

  .btn-dark,
  .btn-outline-dark {
    border-radius: 999px;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    font-size: 0.8rem;
    font-weight: 600;
    padding: 0.6rem 1.4rem;
    transition:
      background-color 0.18s ease-out,
      color 0.18s ease-out,
      border-color 0.18s ease-out,
      transform 0.18s ease-out,
      box-shadow 0.18s ease-out;
  }

  .btn-dark {
    background-color: #000000;
    border-color: #000000;
    color: #ffffff;
  }

  .btn-dark:hover {
    background-color: #222222;
    border-color: #222222;
    transform: translateY(-1px);
    box-shadow: 0 10px 26px rgba(0, 0, 0, 0.6);
  }

  .btn-outline-dark {
    background-color: transparent;
    border-color: #4b5563;
    color: #111827;
  }

  .btn-outline-dark:hover {
    background-color: #000000;
    border-color: #000000;
    color: #ffffff;
    transform: translateY(-1px);
    box-shadow: 0 10px 26px rgba(0, 0, 0, 0.6);
  }
</style>

<div class="container-fluid">
  <div class="exp-section-header">
    <div>
      <h2 class="exp-section-title">üìä Th·ªëng k√™ chi ti√™u</h2>
      <p class="exp-section-subtitle">
        T·ªïng quan chi ti√™u theo danh m·ª•c v√† th·ªùi gian.
      </p>
    </div>
    <div>
      <a href="{% url 'budget_form' %}" class="btn btn-outline-dark btn-sm">
        üí° ƒê·∫∑t ng√¢n s√°ch
      </a>
    </div>
  </div>

  <div class="row g-4">
    <div class="col-md-6">
      <div class="exp-card p-3 h-100">
        <h5 class="mb-2">C∆° c·∫•u chi ti√™u theo danh m·ª•c</h5>
        <small class="text-muted">Bi·ªÉu ƒë·ªì tr√≤n</small>
        <div class="mt-3">
          <canvas id="pieChart"></canvas>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="exp-card p-3 h-100">
        <h5 class="mb-2">Chi ti√™u theo danh m·ª•c</h5>
        <small class="text-muted">Bi·ªÉu ƒë·ªì c·ªôt</small>
        <div class="mt-3">
          <canvas id="barChart"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const chartLabels = JSON.parse('{{ labels|safe|escapejs }}');
  const chartData = JSON.parse('{{ data|safe|escapejs }}');

  new Chart(document.getElementById("pieChart"), {
    type: "pie",
    data: {
      labels: chartLabels,
      datasets: [{
        data: chartData,
        backgroundColor: [
          "#000000",
          "#1f2933",
          "#4b5563",
          "#9ca3af",
          "#111827",
          "#6b7280"
        ],
        borderWidth: 1,
        borderColor: "#ffffff"
      }]
    },
    options: {
      plugins: {
        legend: {
          position: "bottom"
        }
      }
    }
  });

  new Chart(document.getElementById("barChart"), {
    type: "bar",
    data: {
      labels: chartLabels,
      datasets: [{
        label: "Chi ti√™u",
        data: chartData,
        backgroundColor: "#000000"
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      },
      plugins: {
        legend: { display: false }
      }
    }
  });
</script>
{% endblock %}
